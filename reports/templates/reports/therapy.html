{% extends "base.html" %}

{% block extrahead %}
    {% load static %}
    <link rel="stylesheet" href="{% static 'reports/style_e2.css' %}">
{% endblock %}

{% block content %}
<content>
    <a class="btn btn-primary btn-sm" href="{% url 'reports:index' %}" role="button">Start</a>
    <a class="btn btn-primary btn-sm" href="{% url 'reports:patient' patient.patient_id %}" role="button">Zurück</a>
    <a class="btn btn-primary btn-sm" href="{% url 'reports:edit_therapy' therapy.id %}" role="button">Rezeptdaten ändern</a>
    <a class="btn btn-primary btn-sm" href="{% url 'reports:add_process_report' %}?id={{ therapy.id }}" role="button">Verlauf ergänzen</a>
    {% if request.user.groups.all.0.name == 'Leitung' %}
        <a class="btn btn-primary btn-sm" href="{% url 'reports:show_process_report' %}?id={{ therapy.id }}" role="button">Verlauf als PDF</a>
    {% endif %}
    {% if therapy_report.therapy_id %}
        <a class="btn btn-primary btn-sm" href="{% url 'reports:edit_therapy_report' therapy_report.id%}" role="button">Therapiebericht ändern.</a>
    {% else %}
        <a class="btn btn-primary btn-sm" href="{% url 'reports:add_therapy_report' %}?id={{ therapy.id }}" role="button">Therapiebericht anl.</a>
    {% endif %}
    {% if request.user.groups.all.0.name == 'Leitung' %}
        <a class="btn btn-primary btn-sm" href="{% url 'reports:show_therapy_report' %}?id={{ therapy.id }}" role="button">Therapiebericht als PDF</a>
    {% endif %}
    <p></p>
    <div class="container">
        <div class="row">
            <div class="col-sm">
                Patient: <strong>{{ patient.pa_last_name }}, {{ patient.pa_first_name }} </strong>
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col-sm">
                Therapiedaten:
            </div>
        </div>

        <div class="row">
            <div class="col-sm">
                Rezeptdatum: <strong>{{ therapy.recipe_date|date:"d.m.Y" }}</strong>
            </div>
            <div class="col-sm">
                Beginn: <strong>{{ therapy.therapy_start|date:"d.m.Y" }}</strong>
            </div>
            <div class="col-sm">
                Ende: <strong>{{ therapy.therapy_end|date:"d.m.Y" }}</strong>
            </div>
        </div>

    </div>
    <br>
    <table class="table table-striped">
      <thead class="thead-dark">
        <tr>
          <th scope="col" class="align-top">Behand-<br>lung:</th>
          <th scope="col" class="align-top">Therapieinhalt</th>
          <th scope="col" class="align-top">Übungen</th>
          <th scope="col" class="align-top">Ergebnis<br>+ ; - ; 0</th>
        </tr>
      </thead>
      <tbody>
      {% for item in process_report %}
        <tr>
          <th scope="row" class="align-top">{{ item.process_treatment }}</th>
          <td class="align-top">{{ item.process_content }}</td>
          <td class="align-top">{{ item.process_exercises }}</td>
          <td class="align-top">{{ item.process_results }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>

    <table class="table table-striped">
      <thead class="thead-dark">
        <tr>
          <th scope="col" class="align-top" colspan="4">Therapiebericht:</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td scope="col" class="align-top" width="15%">Reportdatum:</td>
          <td class="align-top" colspan="3">{{ therapy_report.report_date }}</td>
        </tr>
        <tr>
          <td scope="col" class="align-top">Indikationsschlüssel:</td>
          <td class="align-top" colspan="3">{{ therapy_report.therapy_indication_key }}</td>
        </tr>
        <tr>
          <td scope="col" class="align-top">Aktueller Stand:</td>
          <td class="align-top" colspan="3">{{ therapy_report.therapy_current_result }}</td>
        </tr>
        <tr>
          <td scope="col" class="align-top">Therapieschwerpunkte:</td>
          <td class="align-top" colspan="3">{{ therapy_report.therapy_emphases }}</td>
        </tr>
        <tr>
          <td scope="col" class="align-top">Prognose:</td>
          <td class="align-top" colspan="3">{{ therapy_report.therapy_forecast }}</td>
        </tr>
        <tr>
          <td scope="col" class="align-top">Behandlung weiter indiziert:</td>
          <td class="align-top" colspan="3">{% if therapy_report.therapy_indicated %} X {% endif %}</td>
        </tr>
        <tr>
          <td scope="col" class="align-top">Pause:</td>
          <td class="align-top">{% if therapy_report.therapy_break %} X {% endif %}</td>
          <td class="align-top" width="15%">Fortsetzung ab:</td>
          <td class="align-top">{{ therapy_report.therapy_break_date|date:"d.m.Y" }}</td>
        </tr>
        <tr>
          <td scope="col" class="align-top">Erfolgreich abgeschlossen:</td>
          <td class="align-top">{% if therapy_report.therapy_success %} X {% endif %}</td>
          <td class="align-top">am:</td>
          <td class="align-top">{{ therapy_report.therapy_success_date|date:"d.m.Y" }}</td>
        </tr>
      </tbody>
    </table>

</content>
{% endblock %}