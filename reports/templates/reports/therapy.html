{% extends "base.html" %}

{% block extrahead %}
    {% load static %}
    <link rel="stylesheet" href="{% static 'reports/style_e2.css' %}">
{% endblock %}

{% block nav %}
<nav class="navbar navbar-expand-sm bg-primary navbar-dark">
  <a class="navbar-brand" href="{% url 'reports:index' %}" >Patient suchen</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="collapsibleNavbar">
    <ul class="navbar-nav">
      <li class="nav-item">
          <a class="btn btn-primary btn-sm" href="{% url 'reports:patient' patient.id %}" role="button">Deckblatt</a>
      </li>
      <li class="nav-item">
          <a class="btn btn-primary btn-sm" href="{% url 'reports:edit_therapy' therapy.id %}" role="button">Rezept ändern</a>
      </li>
      <li class="nav-item">
        {% if ia.therapy_id %}
          <a class="btn btn-primary btn-sm" href="{% url 'reports:edit_ia' ia.id %}" role="button">Befundb. änd.</a>
        {% else %}
          <a class="btn btn-primary btn-sm" href="{% url 'reports:add_ia' %}?id={{ therapy.id }}" role="button">Befundb.</a>
        {% endif %}
      </li>
      <li class="nav-item">
          <a class="btn btn-primary btn-sm" href="{% url 'reports:add_process_report' %}?id={{ therapy.id }}" role="button">Verlauf</a>
      </li>
    {% if request.user.groups.all.0.name == 'Leitung' %}
      <li class="nav-item">
        <a class="btn btn-primary btn-sm" href="{% url 'reports:show_process_report' %}?id={{ therapy.id }}" role="button">Verlauf als PDF</a>
      </li>
    {% endif %}
      <li class="nav-item">
        {% if therapy_report.therapy_id %}
            <a class="btn btn-primary btn-sm" href="{% url 'reports:edit_therapy_report' therapy_report.id%}" role="button">Th.Bericht ändern</a>
        {% else %}
            <a class="btn btn-primary btn-sm" href="{% url 'reports:add_therapy_report' %}?id={{ therapy.id }}" role="button">Th.Bericht anl.</a>
        {% endif %}
      </li>
        {% if therapy_report.therapy_id %}
            {% if request.user.groups.all.0.name == 'Leitung' %}
                {% if therapy_report.report_date == None %}
                    <li class="nav-item">
                        <a class="btn btn-primary btn-sm" href="{% url 'reports:edit_therapy_report' therapy_report.id%}" role="button"><div class="text-warning">Endedatum eintragen</div></a>
                    </li>
                {% else %}
                    <li class="nav-item">
                        <a class="btn btn-primary btn-sm" href="{% url 'reports:show_therapy_report' %}?id={{ therapy.id }}" role="button">Therapiebericht als PDF</a>
                    </li>
                {% endif %}
            {% endif %}
        {% endif %}
    </ul>
  </div>
</nav>
{% endblock %}

{% block content %}
<content>
    <p></p>
    <div class="container">
        <div class="row">
            <div class="col-sm">
                Patient: <strong>{{ patient.pa_last_name }}, {{ patient.pa_first_name }}</strong>
            </div>
            <div class="col-sm">
                Arzt: <strong>{{ therapy.therapy_doctor|truncatechars:40 }}</strong>
            </div>
            <div class="col-sm">
                Rezeptdatum: <strong>{{ therapy.recipe_date|date:"d.m.Y" }}</strong>
            </div>

        </div>
        <br>
       <div class="row">
            <div class="col-sm">
                Verordnungsmenge: <strong>{{ therapy.therapy_regulation_amount }} </strong>
            </div>
            <div class="col-sm">
                Indikationsschlüssel: <strong>{{ therapy.therapy_indication_key }}</strong>
            </div>
            <div class="col-sm">
                Therapiebeginn: <strong>{{ therapy_report.therapy_start|date:"d.m.Y" }}</strong>
            </div>
        </div>
        <div class="row">
            <div class="col-sm">
                Therapiedauer: <strong>{{ therapy.therapy_duration }}</strong>
            </div>
            <div class="col-sm">
                ICD-CoD: <strong>{{ therapy.therapy_icd_cod }}</strong>
            </div>
            <div class="col-sm">
                Therapieende: <strong>{{ therapy_report.therapy_end|date:"d.m.Y" }}</strong>
            </div>
        </div>

        <div class="row">
            <div class="col-sm">
                Therapiefrequenz: <strong>{{ therapy.therapy_frequence }}</strong>
            </div>
            <div class="col-sm">

            </div>
            <div class="col-sm">
            </div>
        </div>

        <div class="row">
            <div class="col-sm">
                Befreit: <strong>{% if therapy.therapy_rid_of %} ja {% else %} nein {% endif %}</strong>
            </div>
            <div class="col-sm">
                Bericht: <strong>{% if therapy.therapy_report_no_yes %} ja {% else %} nein {% endif %}</strong>
            </div>
            <div class="col-sm">
                Therapeut: <strong>{{ therapy.therapists }}</strong>
            </div>
        </div>

    </div>
    <br>
    <div class="col">
         <ul class="nav nav-tabs" id="myTab" role="tablist">
          <li class="nav-item">
              {% if request.GET.window == "1" %}
                <a class="nav-link active" id="erstbefund-tab" data-toggle="tab" href="#erstbefund" role="tab" aria-controls="erstbefund" aria-selected="false">Erstbefund</a>
              {% else %}
                <a class="nav-link" id="erstbefund-tab" data-toggle="tab" href="#erstbefund" role="tab" aria-controls="erstbefund" aria-selected="false">Erstbefund</a>
              {% endif %}
          </li>
          <li class="nav-item">
              {% if request.GET.window == "2" %}
                <a class="nav-link active" id="verlauf-tab" data-toggle="tab" href="#verlauf" role="tab" aria-controls="verlauf" aria-selected="false">Verlauf</a>
              {% elif request.GET.window == None %}
                <a class="nav-link active" id="verlauf-tab" data-toggle="tab" href="#verlauf" role="tab" aria-controls="verlauf" aria-selected="false">Verlauf</a>
              {% else%}
                <a class="nav-link" id="verlauf-tab" data-toggle="tab" href="#verlauf" role="tab" aria-controls="verlauf" aria-selected="false">Verlauf</a>
              {% endif %}
          </li>
          <li class="nav-item">
              {% if request.GET.window == "3" %}
                <a class="nav-link active" id="therapiebericht-tab" data-toggle="tab" href="#therapiebericht" role="tab" aria-controls="therapiebericht" aria-selected="false">Therapiebericht</a>
              {% else %}
                <a class="nav-link" id="therapiebericht-tab" data-toggle="tab" href="#therapiebericht" role="tab" aria-controls="therapiebericht" aria-selected="false">Therapiebericht</a>
              {% endif %}
          </li>
        </ul>
        <div class="tab-content" id="myTabContent">
              {% if request.GET.window == "1" %}
                  <div class="tab-pane fade show active" id="erstbefund" role="tabpanel" aria-labelledby="erstbefund-tab">
              {% else %}
                  <div class="tab-pane fade" id="erstbefund" role="tabpanel" aria-labelledby="erstbefund-tab">
              {% endif %}
              <div class="row bg-light">
                  <div class="col-sm-2">&nbsp;</div>
                  <div class="col-sm-10"></div>
              </div>
              <div class="row bg-secondary">
                  <div class="col-sm-2 text-white">Erstbefund {% if ia.therapy_id %}<a class="text-white" href="{% url 'reports:edit_ia' ia.id %}">(ändern)</a>{% endif %}</div>
                  <div class="col-sm-10"></div>
              </div>
              <div class="row bg-white ">
                  <div class="col-sm-2">Befunddatum:</div>
                  <div class="col-sm-10"><strong>{{ ia.ia_date|date:"d.m.Y" }}</strong></div>
              </div>
              <div class="row bg-light">
                  <div class="col-sm-2">Befund:</div>
                  <div class="col-sm-10"><strong>{{ ia.ia_assessment }}</strong></div>
              </div>
              <div class="row bg-white">
                  <div class="col-sm-2">Artikulation:</div>
                  <div class="col-sm-10"><strong>{{ ia.ia_artikulation }}</strong></div>
              </div>
              <div class="row bg-light">
                  <div class="col-sm-2">Syntax:</div>
                  <div class="col-sm-10"><strong>{{ ia.ia_syntax }}</strong></div>
              </div>
              <div class="row bg-white">
                  <div class="col-sm-2">Semantik:</div>
                  <div class="col-sm-10"><strong>{{ ia.ia_semantik }}</strong></div>
              </div>
              <div class="row bg-light">
                  <div class="col-sm-2">Sprachverständnis:</div>
                  <div class="col-sm-10"><strong>{{ ia.ia_understanding }}</strong></div>
              </div>
              <div class="row bg-white">
                  <div class="col-sm-2">Sprechablauf / Flüssigkeit / Prosodie:</div>
                  <div class="col-sm-10"><strong>{{ ia.ia_expiration }}</strong></div>
              </div>
              <div class="row bg-light">
                  <div class="col-sm-2">Mundmotorik:</div>
                  <div class="col-sm-10"><strong>{{ ia.ia_motor_skills }}</strong></div>
              </div>
              <div class="row bg-white">
                  <div class="col-sm-2">Wahrnehmung:</div>
                  <div class="col-sm-10"><strong>{{ ia.ia_perception }}</strong></div>
              </div>
              <div class="row bg-light">
                  <div class="col-sm-2">Stimme / Atmung:</div>
                  <div class="col-sm-10"><strong>{{ ia.ia_breathing }}</strong></div>
              </div>
              <div class="row bg-white">
                  <div class="col-sm-2">Sonstiges:</div>
                  <div class="col-sm-10"><strong>{{ ia.ia_other }}</strong></div>
              </div>
              <div class="row bg-light">
                  <div class="col-sm-2"></div>
                  <div class="col-sm-10"><strong></strong></div>
              </div>
              <div class="row bg-white">
                  <div class="col-sm-2">Test:</div>
                  <div class="col-sm-10"><strong>{{ ia.ia_test }}</strong></div>
              </div>
              <div class="row bg-light">
                  <div class="col-sm-2">Testdatum:</div>
                  <div class="col-sm-10"><strong>{{ ia.ia_test_date }}</strong></div>
              </div>
              <div class="row bg-white">
                  <div class="col-sm-2">Ergebnis:</div>
                  <div class="col-sm-10"><strong>{{ ia.get_ia_test_result_display }}</strong></div>
              </div>
              <div class="row bg-light">
                  <div class="col-sm-2"></div>
                  <div class="col-sm-10"><strong></strong></div>
              </div>
          </div>
              {% if request.GET.window == "2" %}
                      <div class="tab-pane fade show active" id="verlauf" role="tabpanel" aria-labelledby="verlauf-tab">
              {% elif request.GET.window == None %}
                      <div class="tab-pane fade show active" id="verlauf" role="tabpanel" aria-labelledby="verlauf-tab">
              {% else %}
                      <div class="tab-pane fade" id="verlauf" role="tabpanel" aria-labelledby="verlauf-tab">
              {% endif %}
              <div class="row bg-light">
                  <div class="col-sm-2">&nbsp;</div>
                  <div class="col-sm-10"></div>
              </div>
              {% for item in process_report %}
                  <div class="row bg-secondary">
                      <div class="col-sm text-white">Therapie {{ item.process_treatment }} <a class="text-white" href="{% url 'reports:edit_process_report' item.id %}">(ändern)</a></div>
                  </div>
                  <div class="row bg-white ">
                      <div class="col-sm-8">{{ item.process_content|linebreaks }}</div>
                      <div class="col-sm-2">{{ item.process_exercises }}</div>
                      <div class="col-sm-2">{{ item.process_results }}</div>
                  </div>
                  <div class="row bg-white ">
                      <div class="col-sm-8">{{ item.process_content_2|linebreaks }}</div>
                      <div class="col-sm-2">{{ item.process_exercises_2 }}</div>
                      <div class="col-sm-2">{{ item.process_results_2 }}</div>
                  </div>
                  <div class="row bg-white ">
                      <div class="col-sm-8">{{ item.process_content_3|linebreaks }}</div>
                      <div class="col-sm-2">{{ item.process_exercises_3 }}</div>
                      <div class="col-sm-2">{{ item.process_results_3 }}</div>
                  </div>
                  <div class="row bg-white">
                      <div class="col-sm-2">&nbsp;</div>
                      <div class="col-sm-10"></div>
                  </div>
              {% endfor %}
          </div>
              {% if request.GET.window == "3" %}
                  <div class="tab-pane fade show active" id="therapiebericht" role="tabpanel" aria-labelledby="therapiebericht-tab">
              {% else %}
                  <div class="tab-pane fade" id="therapiebericht" role="tabpanel" aria-labelledby="therapiebericht-tab">
              {% endif %}
              <div class="row bg-light">
                  <div class="col-sm-2">&nbsp;</div>
                  <div class="col-sm-10"></div>
              </div>
              <div class="row bg-secondary">
                  <div class="col-sm-2 text-white">Therapiebericht {% if therapy_report.therapy_id %}<a class="text-white" href="{% url 'reports:edit_therapy_report' therapy_report.id%}">(ändern)</a>{% endif %}</div>
                  <div class="col-sm-10"></div>
              </div>
              <div class="row bg-white ">
                  <div class="col-sm-2">Berichtsdatum:</div>
                  <div class="col-sm-10"><strong>{{ therapy_report.report_date }}</strong></div>
              </div>
              <div class="row bg-light">
                  <div class="col-sm-2">Aktueller Stand:</div>
                  <div class="col-sm-10"><strong>{{ therapy_report.therapy_current_result|linebreaks }}</strong></div>
              </div>
              <div class="row bg-white">
                  <div class="col-sm-2">Therapieschwerpunkte:</div>
                  <div class="col-sm-10"><strong>{{ therapy_report.therapy_emphases|linebreaks }}</strong></div>
              </div>
              <div class="row bg-light">
                  <div class="col-sm-2">Prognose:</div>
                  <div class="col-sm-10"><strong>{{ therapy_report.therapy_forecast|linebreaks }}</strong></div>
              </div>
              <div class="row bg-white">
                  <div class="col-sm-2">Behandlung weiter indiziert:</div>
                  <div class="col-sm-10"><strong>{% if therapy_report.therapy_indicated %} X {% endif %}</strong></div>
              </div>
              <div class="row bg-light">
                  <div class="col-sm-2">Pause:</div>
                  <div class="col-sm-2"><strong>{% if therapy_report.therapy_break %} X {% endif %}</strong></div>
                  <div class="col-sm-2">Fortsetzung ab:</div>
                  <div class="col-sm-2"><strong>{{ therapy_report.therapy_break_date|date:"d.m.Y" }}</strong></div>
              </div>
              <div class="row bg-white">
                  <div class="col-sm-2">Erfolgreich abgeschlossen:</div>
                  <div class="col-sm-2"><strong>{% if therapy_report.therapy_success %} X {% endif %}</strong></div>
                  <div class="col-sm-2">am:</div>
                  <div class="col-sm-10"><strong>{{ therapy_report.therapy_success_date|date:"d.m.Y" }}</strong></div>
              </div>
              <div class="row bg-light">
                  <div class="col-sm-2">Bemerkung:</div>
                  <div class="col-sm-10"><strong>{{ therapy_report.therapy_comment }}</strong></div>
              </div>
          </div>
        </div>
    </div>
</content>
{% endblock %}